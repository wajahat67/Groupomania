{"remainingRequest":"/Users/wajahat98/Desktop/projet_7/frontend/node_modules/babel-loader/lib/index.js!/Users/wajahat98/Desktop/projet_7/frontend/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/wajahat98/Desktop/projet_7/frontend/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/wajahat98/Desktop/projet_7/frontend/src/components/PostModifyModal.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/wajahat98/Desktop/projet_7/frontend/src/components/PostModifyModal.vue","mtime":1645452329805},{"path":"/Users/wajahat98/Desktop/projet_7/frontend/babel.config.js","mtime":1643919861000},{"path":"/Users/wajahat98/Desktop/projet_7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1645449017842},{"path":"/Users/wajahat98/Desktop/projet_7/frontend/node_modules/babel-loader/lib/index.js","mtime":1645449018164},{"path":"/Users/wajahat98/Desktop/projet_7/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1645449017842},{"path":"/Users/wajahat98/Desktop/projet_7/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1645449018122}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3dhamFoYXQ5OC9EZXNrdG9wL3Byb2pldF83L2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmxpbmsuanMiOwppbXBvcnQgeyBYQ2lyY2xlSWNvbiB9IGZyb20gIkBoZXJvaWNvbnMvdnVlL3NvbGlkIjsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICJ2dWV4IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJtb2RpZnlNb2RhbCIsCiAgY29tcG9uZW50czogewogICAgWENpcmNsZUljb246IFhDaXJjbGVJY29uCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZTogbnVsbAogICAgfTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHsKICAgIHZhbGlkYXRlZEZpZWxkczogZnVuY3Rpb24gdmFsaWRhdGVkRmllbGRzKCkgewogICAgICBpZiAodGhpcy5wb3N0Lm1lc3NhZ2UgIT0gIiIgfHwgdGhpcy5maWxlICE9IG51bGwgfHwgdGhpcy5wb3N0LmxpbmsgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogIH0sIG1hcFN0YXRlKHsKICAgIG1lc3NhZ2VzOiBmdW5jdGlvbiBtZXNzYWdlcyhzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUubWVzc2FnZTsKICAgIH0sCiAgICBwb3N0OiBmdW5jdGlvbiBwb3N0KHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5wb3N0OwogICAgfQogIH0pKSwKICBtZXRob2RzOiB7CiAgICB1cGxvYWRGaWxlOiBmdW5jdGlvbiB1cGxvYWRGaWxlKCkgewogICAgICB2YXIgZmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKICAgICAgdGhpcy5maWxlID0gZmlsZTsKICAgIH0sCiAgICBtb2RpZnlQb3N0OiBmdW5jdGlvbiBtb2RpZnlQb3N0KCkgewogICAgICAvLyBNw6ptZSBzY2jDqW1hIHF1ZSBwb3VyIGxhIGNyw6lhdGlvbiBkZXMgcG9zdHMsIG1pcyDDoCBwYXJ0IHF1ZSBsZSBwYXlsb2FkIGNvbXBvcnRlIGwnaWQgZHUgcG9zdCBlbiBwbHVzIGR1IGRhdGEKICAgICAgdmFyIGlkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgIGlmICh0aGlzLnBvc3QubWVzc2FnZSAhPT0gbnVsbCkgewogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgibWVzc2FnZSIsIHRoaXMucG9zdC5tZXNzYWdlKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucG9zdC5saW5rICE9PSBudWxsKSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJsaW5rIiwgdGhpcy5wb3N0LmxpbmspOwogICAgICB9CgogICAgICBpZiAodGhpcy5maWxlICE9PSBudWxsKSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJpbWFnZSIsIHRoaXMuZmlsZSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJ1cGRhdGVQb3N0IiwgewogICAgICAgIGlkOiBpZCwKICAgICAgICBkYXRhOiBmb3JtRGF0YQogICAgICB9KTsKICAgIH0sCiAgICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlIik7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/wajahat98/Desktop/projet_7/frontend/src/components/PostModifyModal.vue"],"names":[],"mappings":";;AA+EA,SAAS,WAAT,QAA4B,sBAA5B;AACA,SAAS,QAAT,QAAyB,MAAzB;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,aADO;AAGb,EAAA,UAAU,EAAE;AAAE,IAAA,WAAU,EAAV;AAAF,GAHC;AAKb,EAAA,IAAI,EAAE,gBAAW;AACf,WAAO;AACL,MAAA,IAAI,EAAE;AADD,KAAP;AAGD,GATY;AAWb,EAAA,QAAQ;AACN,IAAA,eAAe,EAAE,2BAAW;AAC1B,UACE,KAAK,IAAL,CAAU,OAAV,IAAqB,EAArB,IACA,KAAK,IAAL,IAAa,IADb,IAEA,KAAK,IAAL,CAAU,IAAV,IAAkB,IAHpB,EAIE;AACA,eAAO,IAAP;AACF,OANA,MAMO;AACL,eAAO,KAAP;AACF;AACD;AAXK,KAaH,QAAQ,CAAC;AACV,IAAA,QAAQ,EAAE,kBAAC,KAAD;AAAA,aAAW,KAAK,CAAC,OAAjB;AAAA,KADA;AAEV,IAAA,IAAI,EAAE,cAAC,KAAD;AAAA,aAAW,KAAK,CAAC,IAAjB;AAAA;AAFI,GAAD,CAbL,CAXK;AA8Bb,EAAA,OAAO,EAAE;AACP,IAAA,UADO,wBACM;AACX,UAAM,IAAG,GAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,CAAtB,CAAb;AACA,WAAK,IAAL,GAAY,IAAZ;AACD,KAJM;AAMP,IAAA,UAAU,EAAE,sBAAW;AACrB;AAEA,UAAI,EAAC,GAAI,KAAK,MAAL,CAAY,MAAZ,CAAmB,EAA5B;AAEA,UAAM,QAAO,GAAI,IAAI,QAAJ,EAAjB;;AAEA,UAAI,KAAK,IAAL,CAAU,OAAV,KAAsB,IAA1B,EAAgC;AAC9B,QAAA,QAAQ,CAAC,MAAT,CAAgB,SAAhB,EAA2B,KAAK,IAAL,CAAU,OAArC;AACF;;AAEA,UAAI,KAAK,IAAL,CAAU,IAAV,KAAmB,IAAvB,EAA6B;AAC3B,QAAA,QAAQ,CAAC,MAAT,CAAgB,MAAhB,EAAwB,KAAK,IAAL,CAAU,IAAlC;AACF;;AACA,UAAI,KAAK,IAAL,KAAc,IAAlB,EAAwB;AACtB,QAAA,QAAQ,CAAC,MAAT,CAAgB,OAAhB,EAAyB,KAAK,IAA9B;AACF;;AAEA,WAAK,MAAL,CAAY,QAAZ,CAAqB,YAArB,EAAmC;AACjC,QAAA,EAAE,EAAE,EAD6B;AAEjC,QAAA,IAAI,EAAE;AAF2B,OAAnC;AAID,KA5BM;AA8BP,IAAA,KA9BO,mBA8BC;AACN,WAAK,KAAL,CAAW,OAAX;AACD;AAhCM;AA9BI,CAAf","sourcesContent":["<template>\n  <transition name=\"modal-fade\">\n    <div class=\"fixed bottom-0 inset-x-0 flex\" @click.stop>\n      <div class=\"fixed inset-0 transition-opacity\">\n        <div\n          class=\"absolute overflow-y-auto inset-0 bg-gray-200 backdrop-filter backdrop-blur-md bg-opacity-40\"\n        >\n          <div\n            class=\"relative z-10 bg-white shadow-xl rounded-xl py-10 px-8 flex flex-col justify-center items-center w-11/12 lg:w-1/3 my-40 mx-auto\"\n            role=\"dialog\"\n            aria-modal=\"true\"\n            aria-label=\"modal modification de post\"\n          >\n            <div>\n              <button\n                type=\"button\"\n                aria-label=\"fermer\"\n                @click=\"close\"\n                class=\"absolute -top-4 -right-4\"\n              >\n                <XCircleIcon\n                  class=\"h-10 w-10  text-pink-500 hover:text-pink-600\"\n                  aria-label=\"fermer\"\n                />\n              </button>\n            </div>\n            <h2 class=\"flex-start text-xl mb-6\">Modifier un post</h2>\n\n            <form>\n              <div>\n                <textarea\n                  v-model=\"post.message\"\n                  class=\"w-full rounded-md p-2 mb-6 border-2 border-gray-400 outline-none focus:ring-2 focus:ring-gray-400\"\n                  type=\"text\"\n                  placeholder=\"Votre message\"\n                  aria-label=\"Ecrire un message\"\n                />\n\n                <input\n                  @change=\"uploadFile\"\n                  ref=\"file\"\n                  label\n                  for=\"image\"\n                  name=\"image\"\n                  class=\"w-full rounded-md p-2 mb-6 border-2 border-gray-400 outline-none focus:ring-2 focus:ring-gray-400\"\n                  type=\"file\"\n                  accept=\"image/png, image/jpeg, image/gif\"\n                  aria-label=\"Rajouter un fichier\"\n                />\n\n               \n              </div>\n\n              <div class=\"flex justify-center\">\n                <button\n                  type=\"button\"\n                  @click=\"\n                    modifyPost();\n                    close();\n                  \"\n                  class=\" bg-gray-500 hover:bg-gray-600 rounded-md hover:shadow-xl text-white font-bold py-2 px-4  mx-20\"\n                  :disabled=\"!validatedFields\"\n                  :class=\"{ 'opacity-25 cursor-not-allowed': !validatedFields }\"\n                >\n                  <span v-if=\"messages == 'Post modifié !'\"\n                    >Modification en cours...</span\n                  >\n                  <span v-else>Modifier</span>\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\nimport { XCircleIcon } from \"@heroicons/vue/solid\";\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"modifyModal\",\n\n  components: { XCircleIcon },\n\n  data: function() {\n    return {\n      file: null,\n    };\n  },\n\n  computed: {\n    validatedFields: function() {\n      if (\n        this.post.message != \"\" ||\n        this.file != null ||\n        this.post.link != null\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    ...mapState({\n      messages: (state) => state.message,\n      post: (state) => state.post,\n    }),\n  },\n\n  methods: {\n    uploadFile() {\n      const file = this.$refs.file.files[0];\n      this.file = file;\n    },\n\n    modifyPost: function() {\n      // Même schéma que pour la création des posts, mis à part que le payload comporte l'id du post en plus du data\n\n      let id = this.$route.params.id;\n\n      const formData = new FormData();\n\n      if (this.post.message !== null) {\n        formData.append(\"message\", this.post.message);\n      }\n\n      if (this.post.link !== null) {\n        formData.append(\"link\", this.post.link);\n      }\n      if (this.file !== null) {\n        formData.append(\"image\", this.file);\n      }\n\n      this.$store.dispatch(\"updatePost\", {\n        id: id,\n        data: formData,\n      });\n    },\n\n    close() {\n      this.$emit(\"close\");\n    },\n  },\n};\n</script>\n\n<style>\n.modal-fade-enter,\n.modal-fade-leave-to {\n  opacity: 0;\n}\n\n.modal-fade-enter-active,\n.modal-fade-leave-active {\n  transition: opacity 0.5s ease-in-out;\n}\n</style>\n"],"sourceRoot":""}]}